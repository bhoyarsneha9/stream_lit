import streamlit as st
import pandas as pd
from datetime import datetime, timedelta

# Initialize session state
if 'reminders' not in st.session_state:
    st.session_state.reminders = []

# Maintenance tasks
maintenance_tasks = [
    "Oil Change",
    "Tire Rotation",
    "Brake Inspection",
    "Air Filter Replacement",
    "Spark Plug Replacement",
    "Battery Check",
    "Fluid Level Check",
    "Wiper Blade Replacement"
]

# DIY guides
diy_guides = {
    "Oil Change": """
    1. Warm up the engine
    2. Locate the oil drain plug and oil filter
    3. Drain the old oil
    4. Replace the oil filter
    5. Add new oil
    6. Check the oil level
    """,
    "Tire Rotation": """
    1. Loosen the lug nuts on all tires
    2. Lift the vehicle with a jack
    3. Remove the tires
    4. Rotate according to the rotation pattern
    5. Replace the tires and tighten lug nuts
    """,
    "Air Filter Replacement": """
    1. Locate the air filter housing
    2. Open the housing
    3. Remove the old filter
    4. Clean the housing
    5. Insert the new filter
    6. Close the housing
    """
}

# Streamlit app
st.title("Vehicle Maintenance Reminders and DIY Guides")

# Maintenance Reminders
st.header("Maintenance Reminders")

# Add new reminder
st.subheader("Add New Reminder")
task = st.selectbox("Select Maintenance Task", maintenance_tasks)
date = st.date_input("Select Due Date")
if st.button("Add Reminder"):
    st.session_state.reminders.append({"task": task, "date": date})
    st.success("Reminder added successfully!")

# Display reminders
st.subheader("Your Reminders")
if st.session_state.reminders:
    df = pd.DataFrame(st.session_state.reminders)
    df['days_until'] = (df['date'] - datetime.now().date()).dt.days
    df = df.sort_values('date')
    
    for _, reminder in df.iterrows():
        days_until = reminder['days_until']
        if days_until < 0:
            st.error(f"{reminder['task']} - Overdue by {abs(days_until)} days")
        elif days_until == 0:
            st.warning(f"{reminder['task']} - Due today!")
        else:
            st.info(f"{reminder['task']} - Due in {days_until} days")
else:
    st.write("No reminders set. Add some above!")

# DIY Guides
st.header("DIY Maintenance Guides")
selected_guide = st.selectbox("Select a maintenance task", list(diy_guides.keys()))
st.subheader(f"Guide for {selected_guide}")
st.write(diy_guides[selected_guide])

# Maintenance Tips
st.header("General Maintenance Tips")
st.write("""
1. Regular oil changes extend engine life.
2. Rotate tires every 5,000-8,000 miles for even wear.
3. Check fluid levels monthly.
4. Listen for unusual noises and investigate promptly.
5. Keep your car clean to prevent rust and paint damage.
6. Follow your vehicle's recommended maintenance schedule.
7. Address warning lights promptly.
8. Keep tire pressure at recommended levels.
9. Replace wiper blades annually or when streaking occurs.
10. Have your battery tested annually, especially before winter.
""")

# Safety Disclaimer
st.header("Safety Disclaimer")
st.warning("""
Always prioritize safety when performing DIY maintenance. If you're unsure about a procedure, 
consult a professional mechanic. Incorrect maintenance can lead to vehicle damage or personal injury. 
Always refer to your vehicle's owner manual for specific instructions and safety guidelines.
""")
